******************************************************* ADMIN FUNCTIONAL REQUIREMENTS**************************************************************************

------------------------------------------------- REGISTER FORM ----------------------------------------------------------

Imports MySql.Data.MySqlClient

Public Class register
    Dim conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet

    Private Sub createacc_Click(sender As Object, e As EventArgs) Handles createacc.Click
        Try
            Dim firstname = TextBox1.Text
            Dim lastname = TextBox2.Text
            Dim phone_no = TextBox3.Text
            Dim email_add = TextBox4.Text
            Dim password = TextBox5.Text
            Dim sex = ComboBox1.Text
            Dim bday = DateTimePicker1.Value.ToString("yyyy-MM-dd")

            conn.Open()
            sql = $"INSERT INTO customers (firstname, lastname, sex, birthdate, phone_no, email_add, password) VALUES 
       ('{firstname}', '{lastname}', '{sex}', '{bday}','{phone_no}', '{email_add}', SHA1('{password}'))"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery()

            If i > 0 Then
                MsgBox("User account created successfully.")
                standard_rooms.Show()
                Me.Hide()
            Else
                MsgBox("Account creation failed.")
            End If
        Catch ex As Exception
            MsgBox("Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub register_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        ComboBox1.Items.Clear()
        ComboBox1.Items.Add("Female")
        ComboBox1.Items.Add("Male")
        ComboBox1.SelectedIndex = 0

    End Sub
End Class

--------------------------------------------------------------------------------------- LOG IN FORM ----------------------------------------------------------------------------------------------------

Imports MySql.Data.MySqlClient

Public Class login
    Dim conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles log_in.Click
        Try
            conn.Open()
            Dim email_add = TextBox1.Text
            Dim password = TextBox2.Text


            sql = "SELECT * FROM staff WHERE email_add = '" & email_add & "' AND password = '" & password & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            If dbread.HasRows Then
                If dbread.Read() Then
                    MsgBox("Staff login successful!")

                    Dim deptID As Integer = Convert.ToInt32(dbread("dept_id"))

                    If deptID = 1 Then
                        admin_buttons.Show()
                    ElseIf deptID = 2 Then
                        frontdeskstaff_buttons.Show()
                    ElseIf deptID = 3 Then
                        kitchen_buttons.Show()
                    ElseIf deptID = 4 Then
                        equipmentstaff_buttons.Show()
                    End If

                    acc_database.Show()
                    Me.Hide()
                End If

                dbread.Close()
                conn.Close()
                Exit Sub
            End If

            dbread.Close()

            sql = "SELECT * FROM customers WHERE email_add = '" & email_add & "' AND password = SHA1('" & password & "')"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If (dbread.Read) Then
                Me.Hide()

                standard_rooms.Show()
            Else
                MsgBox("invalid email or password")
            End If



        Catch ex As MySqlException
            MsgBox(ex.Message)

            conn.Close()
        Catch ex As Exception
            MsgBox(ex.Message)

            conn.Close()
        End Try
        conn.Close()
    End Sub
End Class

---------------------------------------------------------------------------------------- SUPPLIER FORM --------------------------------------------------------------------------------------------------


Imports MySql.Data.MySqlClient
Public Class suppliers
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim supplierID = Val(ComboBox1.SelectedItem)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers WHERE supplier_id = '" & supplierID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.Read() Then
                TextBox1.Text = dbread("name")
                TextBox2.Text = dbread("contact_person")
                TextBox3.Text = dbread("contact_no")
                TextBox4.Text = dbread("address")
                ComboBox2.Text = dbread("category")
            End If
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally

            conn.Close()
        End Try
    End Sub

    Private Sub suppliers_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("supplier_id"))
            End While
            dbread.Close()

            ComboBox2.Items.Clear()
            ComboBox2.Items.Add("Food")
            ComboBox2.Items.Add("Equipment")
            ComboBox2.SelectedIndex = 0
        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim name = TextBox1.Text
        Dim contactper = TextBox2.Text
        Dim contactno = TextBox3.Text
        Dim address = TextBox4.Text
        Dim category = ComboBox2.SelectedItem.ToString
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"INSERT INTO suppliers (name, contact_person, contact_no, address, category) VALUES ('{name}','{contactper}', '{contactno}', '{address}', '{category}')"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery
            If (i > 0) Then
                MsgBox("record saved")
            Else
                MsgBox("record not saved")
            End If
        Catch ex As MySqlException
            MsgBox("supplier not inserted")
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim category As String = ComboBox2.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers WHERE category = '" & category & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim supplierID = Val(ComboBox1.SelectedItem)
        Dim name = TextBox1.Text
        Dim contactper = TextBox2.Text
        Dim contactno = TextBox3.Text
        Dim address = TextBox4.Text
        Dim category = ComboBox2.SelectedItem.ToString
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"UPDATE suppliers SET name = '{name}', contact_person = '{contactper}', contact_no = '{contactno}', address = '{address}', category = '{category}' WHERE supplier_id = {supplierID}"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery
            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")
            End If
        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            Dim address = TextBox4.Text
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim supplierID = Val(ComboBox1.SelectedItem)
            sql = $"SELECT * FROM suppliers WHERE supplier_id = {supplierID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim query As String = "SELECT * FROM suppliers"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim supplierID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM suppliers WHERE supplier_id = {supplierID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery
                If (i > 0) Then
                    MsgBox("supplier deleted")
                Else
                    MsgBox("supplier not deleted")
                End If
            End If
            TextBox1.Clear()
            TextBox2.Clear()
            TextBox3.Clear()
            TextBox4.Clear()
            ComboBox1.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM suppliers WHERE category = 'Equipment'"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

        Catch ex As Exception
            MsgBox("Error showing Equipment suppliers: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM suppliers WHERE category = 'Food'"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

        Catch ex As Exception
            MsgBox("Error showing Equipment suppliers: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub
End Class


------------------------------------------------- CUSTOMER ACCOUNTS -----------------------------------------------------------------











Imports MySql.Data.MySqlClient

Public Class acc_database
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub acc_database_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = $"SELECT * FROM customers"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "customers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "customers"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("customer_id"))
            End While
            dbread.Close()
            ComboBox2.Items.Clear()
            ComboBox2.Items.Add("Female")
            ComboBox2.Items.Add("Male")
            ComboBox2.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            Dim customerID = Val(ComboBox1.SelectedItem)
            conn.Open()

            sql = $"SELECT * FROM customers WHERE customer_id = {customerID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "customers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "customers"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("customer_id"))
            End While
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
        End Try
    End Sub


    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim firstName = TextBox1.Text
        Dim lastName = TextBox2.Text
        Dim phone = TextBox4.Text
        Dim email = TextBox3.Text
        Dim sex = ComboBox2.SelectedItem.ToString()
        Dim birthdate = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim customerID = Val(ComboBox1.SelectedItem)

        Try
            conn.Open()

            sql = $"UPDATE customers SET firstname = '{firstName}', lastname = '{lastName}', email_add = '{email}', phone_no = '{phone}', 
         sex = '{sex}', birthdate = '{birthdate}' WHERE customer_id = {customerID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()

    End Sub


    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim customerID = Val(ComboBox1.SelectedItem)
        Try
            conn.Open()
            sql = "SELECT * FROM customers WHERE customer_id = " & customerID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.Read() Then
                TextBox1.Text = dbread("firstname").ToString()
                TextBox2.Text = dbread("lastname").ToString()
                TextBox3.Text = dbread("email_add").ToString()
                TextBox4.Text = dbread("phone_no").ToString()
                ComboBox2.SelectedItem = dbread("sex").ToString()
                DateTimePicker1.Value = Convert.ToDateTime(dbread("birthdate"))
            End If
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()

    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM customers"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class









--------------------------------------------------- CUSTOMER LOGS  ------------------------------------------------------------------------









Imports MySql.Data.MySqlClient
Public Class customer_logs
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub customer_logs_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM customer_logs"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "customer_logs")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "customer_logs"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("log_id"))
            End While

            dbread.Close()

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim logID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM customer_logs WHERE log_id = " & logID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox3.Text = dbread("log_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub


    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim reservation_id As String = ComboBox3.Text
        Try
            conn.Open()
            sql = "SELECT * FROM room_reservations WHERE reservation_id = " & reservation_id

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox1.Text = dbread("log_id")


        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM customer_logs"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim logID = ComboBox1.SelectedItem.ToString()
        Dim reservation_id = ComboBox3.SelectedItem.ToString()

        Try
            sql = $"SELECT * FROM customer_logs WHERE log_id = {Val(ComboBox1.SelectedItem)}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "customer_logs")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "customer_logs"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("log_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim action = "check in"
        Dim reservation_id = ComboBox3.SelectedItem.ToString()
        Dim timein = DateTime.Now.ToString("HH:mm:ss")

        Try
            conn.Open()
            sql = $"INSERT INTO customer_logs (reservation_id, action, time_in VALUES('{reservation_id}', '{action}', '{timein}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Staff not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim logID = ComboBox1.SelectedItem.ToString()
        Dim action = "check out"
        Dim reservation_id = ComboBox3.SelectedItem.ToString()
        Dim timeout = DateTime.Now.ToString("HH:mm:ss")

        Try
            conn.Open()
            sql = $"INSERT INTO customer_logs (reservation_id, action, time_in VALUES('{reservation_id}', '{action}', '{timeout}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Staff not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim logID = ComboBox1.SelectedItem.ToString()
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM customer_logs WHERE log_id = {logID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("log deleted")
                Else
                    MsgBox("log not deleted")
                End If
            End If

            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        ComboBox1.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
    End Sub
End Class









----------------------------------------------  ROOMS -------------------------------------------------------------------------









Imports MySql.Data.MySqlClient

Public Class rooms
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub rooms_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM rooms"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "rooms")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "rooms"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("room_id"))
            End While
            dbread.Close()

            ComboBox2.Items.Clear()
            ComboBox2.Items.Add("Standard Room")
            ComboBox2.Items.Add("Deluxe Room")
            ComboBox2.Items.Add("Party Room")
            ComboBox2.Items.Add("VIP Room")
            ComboBox2.SelectedIndex = 0

            ComboBox3.Items.Clear()
            ComboBox3.Items.Add("Available")
            ComboBox3.Items.Add("Not Available")
            ComboBox3.SelectedIndex = 0

            conn.Close()
        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim roomID As String = ComboBox1.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM rooms WHERE room_id = '" & roomID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.Read() Then
                TextBox1.Text = dbread("room_no").ToString()
                TextBox2.Text = dbread("hourly_rate").ToString()
                TextBox3.Text = dbread("capacity").ToString()
                TextBox4.Text = dbread("duration").ToString()
                ComboBox2.Text = dbread("room_type").ToString()
            End If
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim roomtype As String = ComboBox2.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM rooms WHERE room_type = '" & roomtype & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.Read() Then
                TextBox1.Text = dbread("room_no").ToString()
                TextBox2.Text = dbread("hourly_rate").ToString()
                TextBox3.Text = dbread("capacity").ToString()
                TextBox4.Text = dbread("duration").ToString()
                ComboBox1.Text = dbread("room_id").ToString()
            End If
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim query As String = "SELECT * FROM rooms"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim roomID = Val(ComboBox1.SelectedItem)
            sql = $"SELECT * FROM rooms WHERE room_id = {roomID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "rooms")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "rooms"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim roomno = TextBox1.Text
        Dim hourlyrate = TextBox2.Text
        Dim capacity = TextBox3.Text
        Dim roomtype = ComboBox2.SelectedItem.ToString
        Dim duration = TextBox4.Text

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"INSERT INTO rooms (room_type, room_no, hourly_rate, duration, capacity) VALUES ('{roomtype}','{roomno}', '{hourlyrate}', '{duration}', '{capacity}')"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery
            conn.Close()

            If (i > 0) Then
                MsgBox("record saved")
            Else
                MsgBox("record not saved")
            End If
        Catch ex As MySqlException
            MsgBox("room not inserted")
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim roomno = TextBox1.Text
        Dim hourlyrate = TextBox2.Text
        Dim capacity = TextBox3.Text
        Dim roomtype = ComboBox2.SelectedItem.ToString
        Dim roomID = Val(ComboBox1.SelectedItem)
        Dim status = ComboBox3.SelectedItem.ToString

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"UPDATE rooms Set room_type = '{roomtype}', room_no = '{roomno}', hourly_rate = '{hourlyrate}', capacity = '{capacity}',
             status = '{status}' WHERE room_id = {roomID}"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery
            conn.Close()

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")
            End If
        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim roomID = Val(ComboBox1.SelectedItem)
            Dim i As Integer
            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM rooms WHERE room_id = {roomID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("room deleted")
                Else
                    MsgBox("room not deleted")
                End If
            End If

            TextBox1.Clear()
            TextBox2.Clear()
            TextBox3.Clear()

            ComboBox2.SelectedIndex = -1
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim roomtype As String = InputBox("Enter the new Room type:", "Add room type")
            sql = $"INSERT INTO rooms (room_type) VALUES ('{roomtype}')"
            dbcomm = New MySqlCommand(sql, conn)
            dbcomm.ExecuteNonQuery()
            conn.Close()

            MsgBox("New room type added successfully.")
        Catch ex As Exception
            MsgBox("Error adding room type: " & ex.Message)
        End Try
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim status As String = ComboBox3.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM rooms WHERE status = '" & status & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class











------------------------------------------------ SUPPLIERS ------------------------------------------------------------












Imports MySql.Data.MySqlClient
Public Class suppliers
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim supplierID = Val(ComboBox1.SelectedItem)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers WHERE supplier_id = '" & supplierID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.Read() Then
                TextBox1.Text = dbread("name")
                TextBox2.Text = dbread("contact_person")
                TextBox3.Text = dbread("contact_no")
                TextBox4.Text = dbread("address")
                ComboBox2.Text = dbread("category")
            End If
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally

            conn.Close()
        End Try
    End Sub

    Private Sub suppliers_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("supplier_id"))
            End While
            dbread.Close()

            ComboBox2.Items.Clear()
            ComboBox2.Items.Add("Food")
            ComboBox2.Items.Add("Equipment")
            ComboBox2.SelectedIndex = 0
        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim name = TextBox1.Text
        Dim contactper = TextBox2.Text
        Dim contactno = TextBox3.Text
        Dim address = TextBox4.Text
        Dim category = ComboBox2.SelectedItem.ToString
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"INSERT INTO suppliers (name, contact_person, contact_no, address, category) VALUES ('{name}','{contactper}', '{contactno}', '{address}', '{category}')"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery
            If (i > 0) Then
                MsgBox("record saved")
            Else
                MsgBox("record not saved")
            End If
        Catch ex As MySqlException
            MsgBox("supplier not inserted")
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim category As String = ComboBox2.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers WHERE category = '" & category & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim supplierID = Val(ComboBox1.SelectedItem)
        Dim name = TextBox1.Text
        Dim contactper = TextBox2.Text
        Dim contactno = TextBox3.Text
        Dim address = TextBox4.Text
        Dim category = ComboBox2.SelectedItem.ToString
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"UPDATE suppliers SET name = '{name}', contact_person = '{contactper}', contact_no = '{contactno}', address = '{address}', category = '{category}' WHERE supplier_id = {supplierID}"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery
            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")
            End If
        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            Dim address = TextBox4.Text
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim supplierID = Val(ComboBox1.SelectedItem)
            sql = $"SELECT * FROM suppliers WHERE supplier_id = {supplierID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim query As String = "SELECT * FROM suppliers"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim supplierID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM suppliers WHERE supplier_id = {supplierID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery
                If (i > 0) Then
                    MsgBox("supplier deleted")
                Else
                    MsgBox("supplier not deleted")
                End If
            End If
            TextBox1.Clear()
            TextBox2.Clear()
            TextBox3.Clear()
            TextBox4.Clear()
            ComboBox1.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM suppliers WHERE category = 'Equipment'"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

        Catch ex As Exception
            MsgBox("Error showing Equipment suppliers: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM suppliers WHERE category = 'Food'"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "suppliers")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "suppliers"

        Catch ex As Exception
            MsgBox("Error showing Equipment suppliers: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub
End Class












                                        ----------------------------------------------------------------------------
                                                                   FOOD INVENTORY
                                        ----------------------------------------------------------------------------









Imports MySql.Data.MySqlClient
Public Class food_inventory
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub alerts()
        For Each row As DataGridViewRow In DataGridView1.Rows
            If row.IsNewRow Then Continue For

            Dim status = row.Cells("status").Value
            Dim quantity = row.Cells("quantity").Value
            Dim expDate = row.Cells("expiration_date").Value

            If expDate IsNot Nothing AndAlso CDate(expDate).Date = Today Then
                row.Cells("status").Value = "expired"
                row.DefaultCellStyle.BackColor = Color.Red
                row.DefaultCellStyle.ForeColor = Color.Black

            ElseIf IsNumeric(quantity) AndAlso Val(quantity) <= 2 Then
                row.DefaultCellStyle.BackColor = Color.Orange
                row.DefaultCellStyle.ForeColor = Color.White
            End If
        Next
    End Sub


    Private Sub food_inventory_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM food_inventory"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_inventory")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_inventory"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("food_id"))
            End While
            dbread.Close()

            alerts()

            sql = "SELECT supplier_id FROM suppliers"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox3.Items.Clear()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("supplier_id"))
            End While
            dbread.Close()

            ComboBox4.Items.Clear()
            ComboBox4.Items.Add("Fresh")
            ComboBox4.Items.Add("Expired")
            ComboBox4.Items.Add("Low Stock!")
            ComboBox4.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub



    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim foodID = Val(ComboBox1.SelectedItem)

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"SELECT * FROM food_inventory WHERE food_id = {foodID}"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            alerts()

            If dbread.HasRows AndAlso dbread.Read() Then
                TextBox1.Text = dbread("name")
                TextBox2.Text = dbread("quantity").ToString()
                TextBox3.Text = dbread("unit")
                DateTimePicker1.Value = Convert.ToDateTime(dbread("last_restock"))
                DateTimePicker2.Value = Convert.ToDateTime(dbread("expiration_date"))
                ComboBox4.Text = dbread("status")
                ComboBox3.Text = dbread("supplier_id")
            End If

        Catch ex As Exception
            MsgBox("Error loading inventory details: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim name = TextBox1.Text
        Dim quantity = Val(TextBox2.Text)
        Dim units = TextBox3.Text
        Dim last_restock = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim expiration_date = DateTimePicker2.Value.ToString("yyyy-MM-dd")
        Dim status = ComboBox4.Text
        Dim supplierID = Val(ComboBox3.Text)

        Dim i As Integer = 0
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"INSERT INTO food_inventory (supplier_id, name, quantity, unit, last_restock, expiration_date, status) VALUES( 
            {supplierID}, '{name}', {quantity}, '{units}', '{last_restock}', '{expiration_date}', '{status}')"

            dbcomm = New MySqlCommand(sql, conn)
            i = dbcomm.ExecuteNonQuery


            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Ingredient not added. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim supplierID = Val(ComboBox3.Text)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"SELECT * FROM suppliers WHERE supplier_id = {supplierID}"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.HasRows Then dbread.Read()


        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim status = ComboBox4.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"SELECT * FROM food_inventory WHERE status = '{status}'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.HasRows Then dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim query As String = "SELECT * FROM food_inventory"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table

            ComboBox1.Items.Clear()
            sql = "SELECT food_id FROM food_inventory"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("food_id"))
            End While
            dbread.Close()

        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
        alerts()
    End Sub


    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim foodID = Val(ComboBox1.SelectedItem)

            sql = $" SELECT * FROM food_inventory WHERE food_id = {foodID}"

            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_inventory")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_inventory"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.HasRows Then dbread.Read()
            dbread.Close()

        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
        alerts()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim name = TextBox1.Text
        Dim quantity = Val(TextBox2.Text)
        Dim units = TextBox3.Text
        Dim last_restock = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim expiration_date = DateTimePicker2.Value.ToString("yyyy-MM-dd")
        Dim status = ComboBox4.SelectedItem.ToString()
        Dim supplierID = Val(ComboBox3.SelectedItem)
        Dim foodID = Val(ComboBox1.SelectedItem)
        Dim i As Integer = 0

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"UPDATE food_inventory SET supplier_id = {supplierID}, name = '{name}', quantity = {quantity}, unit = '{units}', last_restock = '{last_restock}',
expiration_date = '{expiration_date}', status = '{status}' WHERE food_id = {foodID}"

            dbcomm = New MySqlCommand(sql, conn)
            i = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record Not updated")
            End If

        Catch ex As Exception
            MsgBox("Error updating record:  " & ex.Message)
        End Try
        alerts()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim foodID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM food_inventory WHERE food_id = {foodID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("food deleted")
                Else
                    MsgBox("food not deleted")
                End If
            End If
            TextBox1.Text = ""
            TextBox2.Text = ""
            TextBox3.Text = ""
            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
            ComboBox4.SelectedIndex = -1
            DateTimePicker1.Value = DateTime.Now
            DateTimePicker2.Value = DateTime.Now
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
        alerts()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        ComboBox4.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
        DateTimePicker2.Value = DateTime.Now
        alerts()
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class







---------------------------------------------------- EQUIPMENT INVENTORY ---------------------------------------------------------










Imports MySql.Data.MySqlClient

Public Class food_inventory
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub alerts()
        For Each row As DataGridViewRow In DataGridView1.Rows
            If row.IsNewRow Then Continue For

            Dim status = row.Cells("status").Value
            Dim quantity = row.Cells("quantity").Value
            Dim expDate = row.Cells("expiration_date").Value

            If expDate IsNot Nothing AndAlso CDate(expDate).Date = Today Then
                row.Cells("status").Value = "expired"
                row.DefaultCellStyle.BackColor = Color.Red
                row.DefaultCellStyle.ForeColor = Color.Black

            ElseIf IsNumeric(quantity) AndAlso Val(quantity) <= 2 Then
                row.DefaultCellStyle.BackColor = Color.Orange
                row.DefaultCellStyle.ForeColor = Color.White
            End If
        Next
    End Sub


    Private Sub food_inventory_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM food_inventory"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_inventory")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_inventory"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("food_id"))
            End While
            dbread.Close()

            alerts()

            sql = "SELECT supplier_id FROM supplier"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox3.Items.Clear()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("supplier_id").ToString())
            End While
            dbread.Close()

            ComboBox4.Items.Clear()
            ComboBox4.Items.Add("Fresh")
            ComboBox4.Items.Add("Expired")
            ComboBox4.Items.Add("Low Stock!")
            ComboBox4.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub



    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim foodID As Integer = Val(ComboBox1.SelectedItem)

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM food_inventory WHERE food_id = " & foodID
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            dbread = dbcomm.ExecuteReader()

            alerts()

            If dbread.HasRows AndAlso dbread.Read() Then
                TextBox1.Text = dbread("name").ToString()
                TextBox2.Text = dbread("quantity").ToString()
                TextBox3.Text = dbread("unit").ToString()
                DateTimePicker1.Value = Convert.ToDateTime(dbread("last_restock"))
                DateTimePicker2.Value = Convert.ToDateTime(dbread("expiration_date"))
                ComboBox4.Text = dbread("status").ToString()
                ComboBox3.Text = dbread("supplier_id").ToString()
            End If

        Catch ex As Exception
            MsgBox("Error loading inventory details: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim name = TextBox1.Text
        Dim quantity = TextBox2.Text
        Dim units = TextBox3.Text
        Dim last_restock = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim expiration_date = DateTimePicker2.Value.ToString("yyyy-MM-dd")
        Dim status = ComboBox4.SelectedItem.ToString()
        Dim supplierID = ComboBox3.SelectedItem.ToString()
        Dim foodID = Val(ComboBox1.SelectedItem)
        Dim i As Integer = 0
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"INSERT INTO food_inventory (name, quantity, unit, last_restock, expiration_date, status, supplier_id) VALUES( 
            '{name}', '{quantity}', '{units}', '{last_restock}', '{expiration_date}', '{status}','{supplierID}')"

            dbcomm = New MySqlCommand(sql, conn)
            i = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Ingredient not added. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim supplierID = Val(ComboBox3.Text)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers WHERE supplier_id = '" & supplierID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.HasRows Then dbread.Read()


        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim status As String = ComboBox4.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM food_inventory WHERE status = '" & status & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.HasRows Then dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim query As String = "SELECT * FROM food_inventory"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
            alerts()

            ComboBox1.Items.Clear()
            sql = "SELECT food_id FROM food_inventory"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("food_id").ToString())
            End While
            dbread.Close()

        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim foodID = Val(ComboBox1.SelectedItem)

            sql = $" SELECT * FROM food_inventory WHERE food_id = '{foodID}'"

            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_inventory")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_inventory"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            If dbread.HasRows Then dbread.Read()
            dbread.Close()

        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim name = TextBox1.Text
        Dim quantity = TextBox2.Text
        Dim units = TextBox3.Text
        Dim last_restock = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim expiration_date = DateTimePicker2.Value.ToString("yyyy-MM-dd")
        Dim status = ComboBox4.SelectedItem.ToString()
        Dim supplierID = ComboBox3.SelectedItem.ToString()
        Dim foodID = Val(ComboBox1.SelectedItem)
        Dim i As Integer = 0

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"UPDATE food_inventory SET name = '{name}', quantity = '{quantity}', unit = '{units}', last_restock = '{last_restock}',
expiration_date = '{expiration_date}', status = '{status}',  supplier_id = '{supplierID}' WHERE food_id = '{foodID}'"

            dbcomm = New MySqlCommand(sql, conn)
            i = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record Not updated")
            End If

        Catch ex As Exception
            MsgBox("Error updating record:  " & ex.Message)
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim foodID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM food_inventory WHERE food_id = '{foodID}'"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("food deleted")
                Else
                    MsgBox("food not deleted")
                End If
            End If
            TextBox1.Text = ""
            TextBox2.Text = ""
            TextBox3.Text = ""
            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
            ComboBox4.SelectedIndex = -1
            DateTimePicker1.Value = DateTime.Now
            DateTimePicker2.Value = DateTime.Now
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        ComboBox4.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
        DateTimePicker2.Value = DateTime.Now

    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class










-------------------------------------------------------------   VIP LOGS ----------------------------------------------------------------------------------









Imports MySql.Data.MySqlClient

Public Class vip_logs
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub vip_logs_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM vip_logs"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "vip_log_id")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "vip_log_id"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("vip_log_id"))
            End While

            dbread.Close()

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim viplogid As String = ComboBox1.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM vip_logs WHERE vip_log_id = " & viplogid

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox1.Text = dbread("vip_log_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim vipID As String = ComboBox3.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM vip_logs WHERE vip_log_id = " & vipID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox3.Text = dbread("vip_log_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim action = "check in"
        Dim reservation_id = ComboBox3.SelectedItem.ToString()
        Dim timein = DateTime.Now.ToString("HH:mm:ss")

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"INSERT INTO vip_logs (reservation_id, action, time_in VALUES('{reservation_id}', '{action}', '{timein}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Staff not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim action = "check out"
        Dim reservation_id = ComboBox3.SelectedItem.ToString()
        Dim timein = DateTime.Now.ToString("HH:mm:ss")

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"INSERT INTO vip_logs (reservation_id, action, time_in VALUES('{reservation_id}', '{action}', '{timein}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Staff not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim query As String = "SELECT * FROM vip_logs"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim viplogid = ComboBox1.SelectedItem.ToString()
        Dim vipID = ComboBox3.SelectedItem.ToString()

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = $"SELECT * FROM vip_logs WHERE vip_log_id = {Val(ComboBox1.SelectedItem)}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "vip_logs")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "vip_logs"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("vip_log_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim viplogid = ComboBox1.SelectedItem.ToString()
        Dim i As Integer
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM vip_logs WHERE vip_log_id = {viplogid}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("record deleted")
                Else
                    MsgBox("record not deleted")
                End If
            End If

            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        ComboBox1.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class









------------------------------------------------------------  SUPPLIER TRANSACTIONS  -----------------------------------------------------------------------------










Imports MySql.Data.MySqlClient
Public Class supplier_transactions
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub supplier_transactions_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM supplier_transactions"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "supplier_transactions")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "supplier_transactions"

            sql = "SELECT transaction_id FROM supplier_transactions ORDER BY transaction_id ASC"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("transaction_id"))
            End While
            dbread.Close()

            sql = "SELECT supplier_id FROM suppliers ORDER BY supplier_id ASC"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox2.Items.Clear()
            While dbread.Read()
                ComboBox2.Items.Add(dbread("supplier_id"))
            End While
            dbread.Close()

            sql = "SELECT food_id FROM food_inventory ORDER BY food_id ASC"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox3.Items.Clear()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("food_id"))
            End While
            dbread.Close()

            sql = "SELECT equipment_id FROM equipment_inventory ORDER BY equipment_id ASC"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox4.Items.Clear()
            While dbread.Read()
                ComboBox4.Items.Add(dbread("equipment_id"))
            End While
            dbread.Close()

            ComboBox6.Items.Clear()
            ComboBox6.Items.Add("Food")
            ComboBox6.Items.Add("Equipment")
            ComboBox6.SelectedIndex = 0

            ComboBox5.Items.Clear()
            ComboBox5.Items.Add("Delivered")
            ComboBox5.Items.Add("Cancelled")
            ComboBox5.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim transactionID = Val(ComboBox1.SelectedItem)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM supplier_transactions WHERE transaction_id = " & transactionID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            If dbread.Read() Then
                TextBox1.Text = dbread("shipping_fee")
                TextBox2.Text = dbread("purchase_amount")
                TextBox3.Text = dbread("quantity")
                ComboBox5.Text = dbread("status")
                ComboBox2.Text = dbread("supplier_id")
                If dbread("supplier_type") = "Food" Then
                    ComboBox6.Text = "Food"
                ElseIf dbread("supplier_type") = "Equipment" Then
                    ComboBox6.Text = "Equipment"
                End If

                If Not IsDBNull(dbread("food_id")) Then
                    ComboBox3.Text = dbread("food_id")
                ElseIf Not IsDBNull(dbread("equipment_id")) Then
                    ComboBox3.Text = dbread("equipment_id")
                Else
                    ComboBox3.Text = ""
                End If
                If Not IsDBNull(dbread("date_delivered")) Then
                    DateTimePicker1.Value = Convert.ToDateTime(dbread("date_delivered"))
                End If
            Else
                MsgBox("No record found For Transaction ID: " & transactionID)
            End If

        Catch ex As MySqlException
            MsgBox("Database error: " & ex.Message)
        Catch ex As Exception
            MsgBox("Unexpected error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim supplierID = Val(ComboBox2.SelectedItem)

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM suppliers WHERE supplier_id = " & supplierID
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim foodID As Integer = Val(ComboBox3.SelectedItem)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM food_inventory WHERE food_id = " & foodID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim equipmentID = Val(ComboBox4.SelectedItem)
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            sql = "SELECT * FROM equipment_inventory WHERE equipment_id = " & equipmentID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
            conn.Close()
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim query As String = "SELECT * FROM supplier_transactions"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim shipping As Decimal = Convert.ToDecimal(TextBox1.Text)
            Dim purchase As Decimal = Convert.ToDecimal(TextBox2.Text)
            Dim transactionID = Val(ComboBox1.SelectedItem)
            Dim supplierID = Val(ComboBox2.SelectedItem)
            Dim foodID = Val(ComboBox3.SelectedItem)
            Dim equipmentID = Val(ComboBox4.SelectedItem)
            Dim date_d = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim quantity = TextBox3.Text
            Dim status = ComboBox5.Text
            Dim suppliertype = ComboBox6.Text

            sql = $"SELECT * FROM supplier_transactions WHERE transaction_id = {transactionID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "supplier_transactions")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "supplier_transactions"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("transaction_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim shipping As Decimal = Convert.ToDecimal(TextBox1.Text)
            Dim purchase As Decimal = Convert.ToDecimal(TextBox2.Text)
            Dim transactionID = Val(ComboBox1.SelectedItem)
            Dim supplierID = Val(ComboBox2.SelectedItem)
            Dim foodID = Val(ComboBox3.SelectedItem)
            Dim equipmentID = Val(ComboBox4.SelectedItem)
            Dim date_d = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim quantity = TextBox3.Text
            Dim status = ComboBox5.Text
            Dim suppliertype = ComboBox6.Text

            If suppliertype = "Food" Then
                sql = $"INSERT INTO supplier_transactions (supplier_id, supplier_type, food_id, date_delivered,
shipping_fee, purchase_amount, quantity, status) VALUES('{supplierID}', '{suppliertype}', '{foodID}', '{date_d}', 
'{shipping}','{purchase}', '{quantity}', '{status}')"

            ElseIf suppliertype = "Equipment" Then
                sql = $"INSERT INTO supplier_transactions (supplier_id, supplier_type, equipment_id, date_delivered,
shipping_fee, purchase_amount, quantity, status) VALUES('{supplierID}', '{suppliertype}', '{equipmentID}', '{date_d}', 
'{shipping}','{purchase}', '{quantity}', '{status}')"
            End If

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Staff not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim shipping As Decimal = Convert.ToDecimal(TextBox1.Text)
            Dim purchase As Decimal = Convert.ToDecimal(TextBox2.Text)
            Dim transactionID = Val(ComboBox1.SelectedItem)
            Dim supplierID = Val(ComboBox2.SelectedItem)
            Dim foodID = Val(ComboBox3.SelectedItem)
            Dim equipmentID = Val(ComboBox4.SelectedItem)
            Dim date_d = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim quantity = TextBox3.Text
            Dim status = ComboBox5.Text
            Dim suppliertype = ComboBox6.Text

            sql = $"UPDATE supplier_transactions SET supplier_id = '{supplierID}', supplier_type = '{suppliertype}', food_id = '{foodID}', equipment_id = '{equipmentID}', 
           date_delivered = '{date_d}', shipping_fee = '{shipping}', purchase_amount = '{purchase}', quantity = '{quantity}' , status = '{status}' WHERE transaction_id = 
           '{transactionID}'"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
            conn.Close()
        End Try

    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim transactionID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM supplier_transactions WHERE transaction_id = {transactionID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("customer deleted")
                Else
                    MsgBox("customer not deleted")
                End If
            End If
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
            conn.Close()
        End Try

    End Sub

    Private Sub ComboBox6_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox6.SelectedIndexChanged
        Dim suppliertype As String = ComboBox6.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"SELECT * FROM supplier_transactions WHERE supplier_type = '{suppliertype}'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

        Catch ex As MySqlException
            MsgBox("MySQL error: " & ex.Message)
        Catch ex As Exception
            MsgBox("General error: " & ex.Message)
        Finally
            If dbread IsNot Nothing AndAlso Not dbread.IsClosed Then dbread.Close()
            If conn.State = ConnectionState.Open Then conn.Close()
        End Try
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Clear()
        TextBox2.Clear()
        TextBox3.Clear()
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        ComboBox4.SelectedIndex = -1
        ComboBox5.SelectedIndex = -1
        ComboBox6.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class









--------------------------------------     VIP reservation ------------------------------------------------------------------------------------------------------------










Imports System.Windows.Forms.VisualStyles.VisualStyleElement
Imports MySql.Data.MySqlClient
Public Class vip_reservations
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub vip_reservations_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()
            sql = $"SELECT * FROM vip_reservations"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "vip_reservations")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "vip_reservations"

            For Each row As DataGridViewRow In DataGridView1.Rows
                If row.IsNewRow Then Continue For

                Dim status = row.Cells("status").Value

                If status = "Booked" Then
                    row.DefaultCellStyle.BackColor = Color.LightPink
                    row.DefaultCellStyle.ForeColor = Color.Black
                ElseIf status = "Cancelled" Then
                    row.DefaultCellStyle.BackColor = Color.Orange
                    row.DefaultCellStyle.ForeColor = Color.White
                ElseIf status = "No Show" Then
                    row.DefaultCellStyle.BackColor = Color.DarkRed
                    row.DefaultCellStyle.ForeColor = Color.White
                Else status = "Completed"
                    row.DefaultCellStyle.BackColor = Color.White
                    row.DefaultCellStyle.ForeColor = Color.Black
                End If
            Next

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("vip_reservation_id"))
            End While
            dbread.Close()

            sql = $"SELECT room_id FROM rooms"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox2.Items.Clear()
            While dbread.Read()
                ComboBox2.Items.Add(dbread("room_id").ToString())
            End While
            dbread.Close()

            sql = $"SELECT customer_id FROM customers"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox3.Items.Clear()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("customer_id").ToString())
            End While
            dbread.Close()

            ComboBox4.Items.Clear()
            ComboBox4.Items.Add("Free Welcome Food & Drinks")
            ComboBox4.Items.Add("Free Farewell Takeout")
            ComboBox4.Items.Add("Free Cake")
            ComboBox4.SelectedIndex = 0

            ComboBox5.Items.Clear()
            ComboBox5.Items.Add("Completed")
            ComboBox5.Items.Add("Booked")
            ComboBox5.Items.Add("Cancelled")
            ComboBox5.Items.Add("No Show")
            ComboBox5.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim vipID = Val(ComboBox1.SelectedItem)
        Try

            If conn.State = ConnectionState.Closed Then conn.Open()
            sql = $"SELECT * FROM vip_reservations WHERE vip_reservation_id = " & vipID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("time_reserved").ToString()
            DateTimePicker1.Value = Convert.ToDateTime(dbread("date_reserved"))
            ComboBox2.Text = dbread("room_id").ToString()
            ComboBox3.Text = dbread("customer_id").ToString()
            ComboBox4.Text = dbread("vip_perks").ToString()
            ComboBox5.Text = dbread("status").ToString()

            dbread.Close()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim roomID As String = ComboBox2.Text
        Try
            conn.Open()
            sql = $"SELECT * FROM rooms WHERE room_id = " & roomID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim customerID As String = ComboBox3.Text
        Try
            conn.Open()
            sql = $"SELECT * FROM customers WHERE customer_id = " & customerID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox5_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox5.SelectedIndexChanged
        Dim status As String = ComboBox5.Text
        Try
            conn.Open()
            sql = $"SELECT * FROM vip_reservations WHERE status = " & status

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim vipPerks As String = ComboBox4.Text
        Try
            conn.Open()
            sql = $"SELECT * FROM vip_reservations WHERE vip_perks = " & vipPerks

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Try
            conn.Open()
            Dim vipPerks As String = InputBox("Enter the new VIP perk:", "Add VIP Perk")

            sql = $"INSERT INTO vip_reservations (vip_perks) VALUES ('{vipPerks}')"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            MsgBox("New VIP perk added successfully.")

        Catch ex As Exception
            MsgBox("Error adding VIP perk: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM vip_reservations"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            conn.Open()

            Dim vipID = Val(ComboBox1.SelectedItem)
            Dim roomID = Val(ComboBox2.SelectedItem)
            Dim customerID = Val(ComboBox3.SelectedItem)
            Dim vipPerks = Val(ComboBox4.SelectedItem)
            Dim dateReserved = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim timeReserved = TextBox1.Text
            Dim status = Val(ComboBox5.SelectedItem)

            sql = $"SELECT * FROM vip_reservations WHERE vip_reservation_id = {vipID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "vip_reservations")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "vip_reservations"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("vip_reservation_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Try
            conn.Open()

            Dim vipID = Val(ComboBox1.SelectedItem)
            Dim roomID = Val(ComboBox2.SelectedItem)
            Dim customerID = Val(ComboBox3.SelectedItem)
            Dim vipPerks = Val(ComboBox4.SelectedItem)
            Dim dateReserved = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim timeReserved = TextBox1.Text
            Dim status = Val(ComboBox5.SelectedItem)

            sql = $"UPDATE vip_reservations SET vip_reservations_id = '{vipID}', room_id = '{roomID}', customer_id = '{customerID}', 
vip_perks = '{vipPerks}', date_reserved = '{dateReserved}' time_reserved = '{timeReserved}' status = '{status}' WHERE vip_reservation_id = {vipID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim vipID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM vip_reservations WHERE vip_id = {vipID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("vip reservation deleted")
                Else
                    MsgBox("vip reservation not deleted")
                End If
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1
            ComboBox2.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
            ComboBox4.SelectedIndex = -1
            ComboBox5.SelectedIndex = -1
            DateTimePicker1.Value = DateTime.Now
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Clear()
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        ComboBox4.SelectedIndex = -1
        ComboBox5.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class












----------------------------------------------------------------------------    DEPARTMENTS ---------------------------------------------------------------------------------------










Imports MySql.Data.MySqlClient

Public Class departments
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM departments"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            conn.Open()

            Dim deptname = TextBox1.Text
            Dim deptID = ComboBox1.Text.ToString()

            sql = $"SELECT * FROM departments WHERE dept_id = '{deptID}'"

            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "departments")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "departments"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub departments_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM departments"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "departments")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "departments"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("dept_id").ToString())
            End While
            dbread.Close()

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try

    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim deptname = TextBox1.Text
        Dim deptID = ComboBox1.Text.ToString()

        Try
            conn.Open()

            sql = $"INSERT INTO departments (dept_id, dept_name) VALUES('{deptID}', '{deptname}')"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
                TextBox1.Clear()
            Else
                MsgBox("Record not saved.")
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox("Department not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try

    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim deptname = TextBox1.Text
        Dim deptID = {Val(ComboBox1.SelectedItem)}
        Try
            conn.Open()

            sql = $"UPDATE departments SET dept_name = '{deptname}' WHERE dept_id = {deptID}"

            Label1.Text = sql
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()

    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim deptID = Val(ComboBox1.SelectedItem)
        Dim deptname = TextBox1.Text
        Dim i As Integer

        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM departments WHERE dept_id = {deptID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("department deleted")
                Else
                    MsgBox("department not deleted")
                End If
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()

    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Clear()
        ComboBox1.SelectedIndex = -1

    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim deptID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM departments WHERE dept_id = '" & deptID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("dept_name")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class










-----------------------------------------------------------------------   MENU    -----------------------------------------------------------------------------------------------











Imports MySql.Data.MySqlClient
Public Class menu_table
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub menu_table_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM menu"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "menu")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "menu"

            sql = "SELECT menu_id FROM menu ORDER BY menu_id ASC"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("menu_id"))
            End While
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox("Error loading menu IDs: " & ex.Message)
        End Try

        ComboBox2.Items.Clear()
        ComboBox2.Items.Add("Food")
        ComboBox2.Items.Add("Drinks")
        ComboBox2.SelectedIndex = 0

        ComboBox3.Items.Clear()
        ComboBox3.Items.Add("Available")
        ComboBox3.Items.Add("Not Available")
        ComboBox3.SelectedIndex = 0

    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim menuID = Val(ComboBox1.SelectedItem)

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"SELECT * FROM menu WHERE menu_id = {menuID}"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            If dbread.Read() Then
                TextBox1.Text = dbread("name").ToString()
                TextBox3.Text = dbread("flavor").ToString()
                TextBox2.Text = dbread("price").ToString()
                ComboBox2.Text = dbread("category").ToString()
                ComboBox3.Text = dbread("status").ToString()
            End If
            dbread.Close()
            conn.Close()
        Catch ex As Exception
            MsgBox("Error loading menu details: " & ex.Message)
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT * FROM menu"
            adapter = New MySqlDataAdapter(sql, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = table

        Catch ex As Exception
            MsgBox("Error refreshing data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        If ComboBox1.SelectedIndex = -1 Then
            MsgBox("Please select a menu item to search.")
            Exit Sub
        End If

        Dim menuID = ComboBox1.SelectedItem.ToString()

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"SELECT * FROM menu WHERE menu_id = {menuID}"
            adapter = New MySqlDataAdapter(sql, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = table
        Catch ex As Exception
            MsgBox("Error collecting data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Try
            Dim i As Integer = 0
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim name = TextBox1.Text
            Dim flavor = TextBox3.Text
            Dim price = Convert.ToDecimal(TextBox2.Text)
            Dim category = ComboBox2.Text
            Dim status = ComboBox3.Text
            sql = $"INSERT INTO menu (name, flavor, category, price, status) VALUES('{name}', '{flavor}', '{category}', '{price}' , '{status}')"
            dbcomm = New MySqlCommand(sql, conn)
            i = dbcomm.ExecuteNonQuery
            If (i > 0) Then
                MsgBox("food added to menu")
            Else
                MsgBox("food not added to menu")
            End If
        Catch ex As Exception
            MsgBox("Insertion Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Try
            Dim i As Integer = 0
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()
            Dim menuID = Val(ComboBox1.SelectedItem)
            Dim ans = MessageBox.Show("Do you want to delete this record?", "Confirm Delete", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM menu WHERE menu_id = {menuID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery
                If (i > 0) Then
                    MsgBox("food deleted")
                Else
                    MsgBox("food not deleted")
                End If
            End If

            TextBox1.Clear()
            TextBox2.Clear()
            TextBox3.Clear()
            ComboBox1.SelectedIndex = -1
            ComboBox2.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1

        Catch ex As Exception
            MsgBox("Delete Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim menuID = Val(ComboBox1.Text)
        Dim name = TextBox1.Text
        Dim flavor = TextBox3.Text
        Dim category = ComboBox2.Text
        Dim price = Convert.ToDecimal(TextBox2.Text)
        Dim status = ComboBox3.Text

        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = $"UPDATE menu SET name = '{name}', flavor = '{flavor}', category = '{category}', price = {price}, status = '{status}' WHERE menu_id = {menuID}"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If i > 0 Then
                MsgBox("Menu item updated successfully.")
            Else
                MsgBox("Update failed.")
            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Clear()
        TextBox2.Clear()
        TextBox3.Clear()
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class












----------------------------------------------------------------   STAFF ACCOUNTS   ------------------------------------------------------------------------------













Imports MySql.Data.MySqlClient

Public Class staff_accounts
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM staff"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub staff_accounts_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM staff"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "staff")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "staff"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("staff_id"))
            End While
            dbread.Close()

            ComboBox2.Items.Clear()
            ComboBox2.Items.Add("Female")
            ComboBox2.Items.Add("Male")
            ComboBox2.SelectedIndex = 0

            ComboBox3.Items.Clear()
            ComboBox3.Items.Add("Chef")
            ComboBox3.Items.Add("Inventory Clerk")
            ComboBox3.Items.Add("Cleaner")
            ComboBox3.Items.Add("System Administrator")
            ComboBox3.Items.Add("Equipment Maintenance Staff")
            ComboBox3.Items.Add("Admin Officer")
            ComboBox3.Items.Add("Front Desk Officer")
            ComboBox3.Items.Add("Equipment Manager")
            ComboBox3.SelectedIndex = 0

            ComboBox4.Items.Clear()
            ComboBox4.Items.Add("Active")
            ComboBox4.Items.Add("On Leave")
            ComboBox4.Items.Add("Resigned")
            ComboBox4.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            conn.Open()

            Dim staffID = Val(ComboBox1.SelectedItem)

            sql = $"SELECT * FROM staff WHERE staff_id = {Val(ComboBox1.SelectedItem)}"

            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "staff")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "staff"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim firstname = TextBox1.Text
        Dim lastname = TextBox2.Text
        Dim phone_no = TextBox4.Text
        Dim email = TextBox3.Text
        Dim address = TextBox7.Text
        Dim position = ComboBox3.SelectedItem.ToString()
        Dim status = ComboBox4.SelectedItem.ToString()
        Dim sex = ComboBox2.SelectedItem.ToString()
        Dim birthdate = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim date_hired = DateTimePicker2.Value.ToString("yyyy-MM-dd")
        Dim deptID = ComboBox5.SelectedItem.ToString()
        Dim password = TextBox9.Text

        Try
            conn.Open()
            sql = $"INSERT INTO staff (firstname, lastname, sex, birthdate, address, phone_no, email_add, position, date_hired, 
            status, dept_id, password) VALUES('{firstname}', '{lastname}', '{sex}', '{birthdate}', '{address}', '{phone_no}', '{email}', 
            '{position}', '{date_hired}', '{status}', '{deptID}','{password}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("Staff not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim staffID = Val(ComboBox1.SelectedItem)
        Dim firstname = TextBox1.Text
        Dim lastname = TextBox2.Text
        Dim phone_no = TextBox4.Text
        Dim email = TextBox3.Text
        Dim address = TextBox7.Text
        Dim position = ComboBox3.SelectedItem.ToString()
        Dim status = ComboBox4.SelectedItem.ToString()
        Dim sex = ComboBox2.SelectedItem.ToString()
        Dim birthdate = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Dim date_hired = DateTimePicker2.Value.ToString("yyyy-MM-dd")
        Dim deptID = ComboBox5.SelectedItem.ToString()
        Dim password = TextBox9.Text

        Try
            conn.Open()

            sql = $"UPDATE staff SET firstname = '{firstname}', lastname = '{lastname}', sex = '{sex}', birthdate = '{birthdate}', 
           address = '{address}', phone_no = '{phone_no}', email_add = '{email}', position = '{position}', date_hired = '{date_hired}', 
           status = '{status}', dept_id = '{deptID}', password = '{password}' WHERE staff_id = {staffID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record updated successfully.")
            Else
                MsgBox("No record updated.")
            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        Finally
            conn.Close()
        End Try

    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim staffID = Val(ComboBox1.SelectedItem)
        Dim i As Integer

        Try
            conn.Open()

            ' Check if target is an admin
            Dim checkSQL = $"SELECT dept_id FROM staff WHERE staff_id = {staffID}"
            dbcomm = New MySqlCommand(checkSQL, conn)
            dbread = dbcomm.ExecuteReader()
            Dim isAdminToDelete As Boolean = False

            If dbread.Read() Then
                If Convert.ToInt32(dbread("dept_id")) = 1 Then
                    isAdminToDelete = True
                End If
            End If
            dbread.Close()

            If isAdminToDelete Then
                MsgBox("You cannot delete an admin account.")
                conn.Close()
                Exit Sub
            End If

            Dim ans = MessageBox.Show("Do you want to delete this record?", "Confirm Delete", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM staff WHERE staff_id = {staffID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("Staff deleted.")
                Else
                    MsgBox("Staff not deleted.")
                End If
            End If

            ' Clear fields
            TextBox1.Clear()
            TextBox2.Clear()
            TextBox3.Clear()
            TextBox4.Clear()
            ComboBox1.SelectedIndex = -1

        Catch ex As MySqlException
            MsgBox("MySQL Error: " & ex.Message)
        Catch ex As Exception
            MsgBox("Error: " & ex.Message)
        Finally
            conn.Close()
        End Try

    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
        TextBox7.Text = ""
        TextBox9.Text = ""
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        ComboBox4.SelectedIndex = -1
        ComboBox5.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
        DateTimePicker2.Value = DateTime.Now

    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim staffID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM staff WHERE staff_id = '" & staffID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("firstname")
            TextBox2.Text = dbread("lastname")
            TextBox3.Text = dbread("email_add")
            TextBox4.Text = dbread("phone_no")
            TextBox7.Text = dbread("address")
            TextBox9.Text = dbread("password")
            ComboBox2.Text = dbread("sex")
            ComboBox3.Text = dbread("position")
            ComboBox4.Text = dbread("status")
            ComboBox5.Text = dbread("dept_id")
            DateTimePicker1.Value = Convert.ToDateTime(dbread("birthdate"))
            DateTimePicker2.Value = Convert.ToDateTime(dbread("date_hired"))

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        dbread.Close()
        conn.Close()
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim sex As String = ComboBox2.Text
        Try
            conn.Open()
            sql = "SELECT * FROM staff WHERE sex = '" & sex & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim position As String = ComboBox3.Text
        Try
            conn.Open()
            sql = "SELECT * FROM staff WHERE position = '" & position & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim status As String = ComboBox4.Text
        Try
            conn.Open()
            sql = "SELECT * FROM staff WHERE status = '" & status & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox5_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox5.SelectedIndexChanged
        Dim deptID As String = ComboBox5.Text
        Try
            conn.Open()
            sql = "SELECT * FROM departments WHERE dept_id = '" & deptID & "'"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class












---------------------------------------------------------------------------------      ROOM RESERVATIONS     --------------------------------------------------------------------------------------------












Imports MySql.Data.MySqlClient

Public Class room_reservations
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub room_reservations_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM room_reservations"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "room_reservations")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "room_reservations"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("reservation_id"))
            End While
            dbread.Close()

            sql = "SELECT room_id FROM rooms;"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox2.Items.Clear()
            While dbread.Read()
                ComboBox2.Items.Add(dbread("room_id").ToString())
            End While
            dbread.Close()

            sql = "SELECT customer_id FROM customers"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            ComboBox3.Items.Clear()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("equipment_id").ToString())
            End While
            dbread.Close()

            ComboBox4.Items.Clear()
            ComboBox4.Items.Add("Completed")
            ComboBox4.Items.Add("Booked")
            ComboBox4.Items.Add("Cancelled")
            ComboBox4.Items.Add("No Show")
            ComboBox4.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim reserveID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM room_reservations WHERE reservation_id = " & reserveID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("time_reserved")
            ComboBox2.Text = dbread("room_id")
            ComboBox3.Text = dbread("customer_id")
            ComboBox4.Text = dbread("status")
            DateTimePicker1.Value = Convert.ToDateTime(dbread("date_reserved"))


        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim roomID As String = ComboBox2.Text
        Try
            conn.Open()
            sql = "SELECT * FROM rooms WHERE room_id = " & roomID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim customerID As String = ComboBox3.Text
        Try
            conn.Open()
            sql = "SELECT * FROM customers WHERE customer_id = " & customerID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim status As String = ComboBox4.Text
        Try
            conn.Open()
            sql = "SELECT * FROM room_reservations WHERE status = " & status

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Close()

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM room_reservations"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            conn.Open()

            Dim reservationID = Val(ComboBox1.SelectedItem)
            Dim roomID = Val(ComboBox2.SelectedItem)
            Dim customerID = Val(ComboBox3.SelectedItem)
            Dim dateReserved = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim timeReserved = TextBox1.Text
            Dim status = Val(ComboBox4.SelectedItem)

            sql = $"SELECT * FROM room_reservations WHERE reservation_id = {reservationID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "room_reservations")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "room_reservations"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("reservation_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Try
            conn.Open()

            Dim reservationID = Val(ComboBox1.SelectedItem)
            Dim roomID = Val(ComboBox2.SelectedItem)
            Dim customerID = Val(ComboBox3.SelectedItem)
            Dim dateReserved = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim timeReserved = TextBox1.Text
            Dim status = Val(ComboBox4.SelectedItem)

            sql = $"UPDATE room_reservations SET room_id = '{roomID}', customer_id = '{customerID}', date_reserved = '{dateReserved}', 
tim_reserved = '{timeReserved}', status = '{status}' WHERE reservation_id = {reservationID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim reservationID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM room_reservations WHERE reservation_id = {reservationID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("room_reservation deleted")
                Else
                    MsgBox("room_reservation not deleted")
                End If
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1
            ComboBox2.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
            ComboBox4.SelectedIndex = -1
            DateTimePicker1.Value = DateTime.Now
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Clear()
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        ComboBox4.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim reservationID As Integer = Val(ComboBox1.SelectedItem)

        If reservationID = 0 Then
            MsgBox("Please select a reservation to cancel.")
            Exit Sub
        End If

        Try
            conn.Open()

            Dim ans = MessageBox.Show("Are you sure you want to cancel this reservation? Linked food orders will be canceled too.", "Cancel Reservation", MessageBoxButtons.YesNo)
            If ans = DialogResult.Yes Then

                sql = $"UPDATE room_reservations SET status = 'Cancelled' WHERE reservation_id = {reservationID}"
                dbcomm = New MySqlCommand(sql, conn)
                Dim resResult = dbcomm.ExecuteNonQuery()

                Dim orderIDs As New List(Of Integer)
                Dim menuIDs As New List(Of Integer)
                Dim quantities As New List(Of Integer)
                Dim statuses As New List(Of String)

                sql = $"SELECT order_id, menu_id, quantity, status FROM food_orderline WHERE reservation_id = {reservationID} AND status != 'Canceled'"
                dbcomm = New MySqlCommand(sql, conn)
                dbread = dbcomm.ExecuteReader()

                While dbread.Read()
                    orderIDs.Add(dbread("order_id"))
                    menuIDs.Add(dbread("menu_id"))
                    quantities.Add(dbread("quantity"))
                    statuses.Add(dbread("status").ToString())
                End While
                dbread.Close()

                For i As Integer = 0 To orderIDs.Count - 1
                    Dim orderID = orderIDs(i)
                    Dim menuID = menuIDs(i)
                    Dim quantity = quantities(i)
                    Dim status = statuses(i)

                    Dim newStatus As String

                    If status = "Completed" Or status = "Prepared" Then
                        newStatus = "Wasted"
                    Else
                        newStatus = "Cancelled"

                        sql = $"UPDATE menu SET stock = stock + {quantity} WHERE menu_id = {menuID}"
                        dbcomm = New MySqlCommand(sql, conn)
                        dbcomm.ExecuteNonQuery()
                    End If

                    sql = $"UPDATE food_orderline SET status = '{newStatus}' WHERE order_id = {orderID}"
                    dbcomm = New MySqlCommand(sql, conn)
                    dbcomm.ExecuteNonQuery()
                Next

                MsgBox("Reservation successfully canceled. Food orders are canceled too.")

                TextBox1.Clear()
                ComboBox1.SelectedIndex = -1
                ComboBox2.SelectedIndex = -1
                ComboBox3.SelectedIndex = -1
                ComboBox4.SelectedIndex = -1
                DateTimePicker1.Value = DateTime.Now

            End If

        Catch ex As Exception
            MsgBox("Error canceling reservation: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class











-------------------------------------------------------------------   FOOD ORDERS   ---------------------------------------------------------------------------










Imports MySql.Data.MySqlClient

Public Class food_orders
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()

    Private Sub food_orders_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM food_orderline"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_orderline")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_orderline"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("order_id"))
            End While
            dbread.Close()

            sql = "SELECT customer_id FROM customers"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox2.Items.Add(dbread("customer_id"))
            End While
            dbread.Close()

            sql = "SELECT menu_id FROM menu"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("menu_id"))
            End While
            dbread.Close()

            sql = "SELECT reservation_id FROM room_reservations"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            While dbread.Read()
                ComboBox4.Items.Add(dbread("reservation_id"))
            End While
            dbread.Close()

            ComboBox5.Items.Clear()
            ComboBox5.Items.Add("Completed")
            ComboBox5.Items.Add("Canceled")
            ComboBox5.SelectedIndex = 0

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim orderID As String = ComboBox1.Text
        Try
            If conn.State = ConnectionState.Open Then conn.Close()
            conn.Open()

            sql = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id WHERE fo.order_id = " & orderID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            If dbread.Read() Then
                TextBox1.Text = dbread("quantity")
                ComboBox2.Text = dbread("customer_id")
                ComboBox3.Text = dbread("menu_id")
                ComboBox4.Text = dbread("reservation_id")
                ComboBox5.Text = dbread("status")
                DateTimePicker1.Value = Convert.ToDateTime(dbread("order_time"))
                TextBox2.Text = dbread("name")
            End If

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub


    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim customerID = Val(ComboBox2.SelectedItem)
        Try
            conn.Open()
            sql = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id WHERE 
fo.customer_id = " & customerID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("quantity")
            ComboBox1.Text = dbread("order_id")
            ComboBox3.Text = dbread("menu_id")
            ComboBox4.Text = dbread("reservation_id")
            ComboBox5.Text = dbread("status")
            TextBox2.Text = dbread("name")
            DateTimePicker1.Value = Convert.ToDateTime(dbread("order_time"))
            dbread.Close()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim menuID = Val(ComboBox3.SelectedItem)
        Try
            conn.Open()
            sql = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id WHERE 
m.menu_id = " & menuID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("quantity")
            ComboBox2.Text = dbread("customer_id")
            ComboBox1.Text = dbread("order_id")
            ComboBox4.Text = dbread("reservation_id")
            ComboBox5.Text = dbread("status")
            TextBox2.Text = dbread("name")
            DateTimePicker1.Value = Convert.ToDateTime(dbread("order_time"))
            dbread.Close()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox4.SelectedIndexChanged
        Dim reservationID = Val(ComboBox4.SelectedItem)
        Try
            conn.Open()
            sql = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id WHERE 
fo.reservation_id = " & reservationID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("quantity")
            ComboBox2.Text = dbread("customer_id")
            ComboBox3.Text = dbread("menu_id")
            ComboBox1.Text = dbread("order_id")
            ComboBox5.Text = dbread("status")
            TextBox2.Text = dbread("name")
            DateTimePicker1.Value = Convert.ToDateTime(dbread("order_time"))
            dbread.Close()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox5_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox5.SelectedIndexChanged
        Dim status As String = ComboBox5.Text
        Try
            conn.Open()
            sql = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id WHERE 
fo.status = '" & status & "'"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("quantity")
            ComboBox2.Text = dbread("customer_id")
            ComboBox3.Text = dbread("menu_id")
            ComboBox4.Text = dbread("reservation_id")
            ComboBox1.Text = dbread("order_id")
            TextBox2.Text = dbread("name")
            DateTimePicker1.Value = Convert.ToDateTime(dbread("order_time"))
            dbread.Close()
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            conn.Open()

            Dim orderID = Val(ComboBox1.SelectedItem)
            Dim customerID = Val(ComboBox2.SelectedItem)
            Dim menuID = Val(ComboBox3.SelectedItem)
            Dim quantity = TextBox1.Text
            Dim reservationID = Val(ComboBox4.SelectedItem)
            Dim status = Val(ComboBox5.SelectedItem)
            Dim ordertime = DateTimePicker1.Value.ToString("yyyy-MM-dd")

            sql = "SELECT fo.quantity, fo.order_time, fo.customer_id, fo.menu_id, fo.reservation_id, fo.status, 
m.name FROM food_orderline fo INNER JOIN menu m ON fo.menu_id = m.menu_id WHERE fo.order_id = " & orderID
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_orderline")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_orderline"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("order_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim orderID = Val(ComboBox1.SelectedItem)
        Dim customerID = Val(ComboBox2.SelectedItem)
        Dim menuID = Val(ComboBox3.SelectedItem)
        Dim quantity = TextBox1.Text
        Dim reservationID = Val(ComboBox4.SelectedItem)
        Dim status = Val(ComboBox5.SelectedItem)
        Dim ordertime = DateTimePicker1.Value.ToString("yyyy-MM-dd")

        Try
            conn.Open()
            sql = $"INSERT INTO food_orderline (customer_id, menu_id, quantity, reservation_id, status, ordertime) VALUES( '{customerID}',
            '{customerID}', '{menuID}', '{quantity}', '{reservationID}','{status}', '{ordertime}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("food order not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click

        Dim orderID = Val(ComboBox1.SelectedItem)
        Dim customerID = Val(ComboBox2.SelectedItem)
        Dim menuID = Val(ComboBox3.SelectedItem)
        Dim quantity = TextBox1.Text
        Dim reservationID = Val(ComboBox4.SelectedItem)
        Dim status = Val(ComboBox5.SelectedItem)
        Dim ordertime = DateTimePicker1.Value.ToString("yyyy-MM-dd")

        Try
            conn.Open()

            sql = $"UPDATE food_orderline SET quantity = '{quantity}', order_time = '{ordertime}', customer_id = '{customerID}', menu_id = '{menuID}',
         reservation_id = '{reservationID}', status = '{status}' WHERE order_id = {orderID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()

    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim orderID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM food_orderline WHERE order_id = {orderID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("customer deleted")
                Else
                    MsgBox("customer not deleted")
                End If
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1
            ComboBox2.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
            ComboBox4.SelectedIndex = -1
            ComboBox5.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim orderID = Val(ComboBox1.SelectedItem)
        If orderID = 0 Then
            MsgBox("Please select an order to cancel.")
            Exit Sub
        End If

        Try
            conn.Open()

            sql = $"SELECT menu_id, quantity FROM food_orderline WHERE order_id = {orderID}"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            Dim menuID As Integer = 0
            Dim quantity As Integer = 0
            If dbread.Read() Then
                menuID = dbread("menu_id")
                quantity = dbread("quantity")
            End If
            dbread.Close()

            Dim ans = MessageBox.Show("Are you sure you want to cancel this order?", "Cancel Order", MessageBoxButtons.YesNo)
            If ans = DialogResult.Yes Then
                Dim status As String = ComboBox5.Text
                Dim UpdstatPre As String = "Wasted"

                If status = "Prepared" Then
                    sql = $"UPDATE food_orderline SET status = '{UpdstatPre}' WHERE order_id = '{orderID}'"
                Else
                    status = "Canceled"
                    sql = $"UPDATE menu SET stock = stock + {quantity} WHERE menu_id = {menuID}"
                    dbcomm = New MySqlCommand(sql, conn)
                    dbcomm.ExecuteNonQuery()
                End If

                sql = $"UPDATE food_orderline SET status = '{status}' WHERE order_id = {orderID}"
                dbcomm = New MySqlCommand(sql, conn)
                Dim result = dbcomm.ExecuteNonQuery()

                If result > 0 Then
                    MsgBox("Order successfully canceled.")
                    ComboBox5.Text = status
                Else
                    MsgBox("Order could not be canceled.")
                End If
            End If

        Catch ex As Exception
            MsgBox("Error canceling order: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class









-------------------------------------------------------------    CUSTOMER PAYMENTS   -----------------------------------------------------------------------------------












Imports MySql.Data.MySqlClient

Public Class customer_payments
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub customer_payments_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = $"SELECT * FROM customer_payments"
            DataAdapter1 = New MySqlDataAdapter(Sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "customer_payments")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "customer_payments"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(Sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("payment_id"))
            End While

            ComboBox2.Items.Clear()
            While dbread.Read()
                ComboBox2.Items.Add(dbread("customer_id"))
            End While


            ComboBox3.Items.Clear()
            ComboBox3.Items.Add("Reservation")
            ComboBox3.Items.Add("Order")
            ComboBox3.Items.Add("VIP")
            ComboBox3.Items.Add("Amount paid")
            ComboBox3.SelectedIndex = 0

            dbread.Close()

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim payID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM customer_payments WHERE payment_id = " & payID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("amount_paid")
            ComboBox2.Text = dbread("customer_id")
            ComboBox3.Text = dbread("action")
            DateTimePicker1.Value = DateTime.Now

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox2.SelectedIndexChanged
        Dim customerID As String = ComboBox2.Text
        Try
            conn.Open()
            sql = "SELECT * FROM customer_payments WHERE customer_id = " & customerID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("amount_paid")
            ComboBox1.Text = dbread("payment_id")
            ComboBox3.Text = dbread("action")
            DateTimePicker1.Value = DateTime.Now

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim action As String = ComboBox3.Text
        Try
            conn.Open()
            sql = "SELECT * FROM customer_payments WHERE action = " & action

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            TextBox1.Text = dbread("amount_paid")
            ComboBox2.Text = dbread("customer_id")
            ComboBox1.Text = dbread("payment_id")
            DateTimePicker1.Value = DateTime.Now

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM customer_payments"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Try
            conn.Open()

            Dim amountPaid = TextBox1.Text
            Dim payID = ComboBox1.SelectedItem.ToString()
            Dim customerID = ComboBox2.SelectedItem.ToString()
            Dim action = ComboBox3.SelectedItem.ToString()
            Dim paidDate = DateTimePicker1.Value.ToString("yyyy-MM-dd")

            sql = $"SELECT * FROM customer_payments WHERE payment_id = {payID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "customer_payments")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "customer_payments"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("payment_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim amountPaid = TextBox1.Text
        Dim payID = ComboBox1.SelectedItem.ToString()
        Dim customerID = ComboBox2.SelectedItem.ToString()
        Dim action = ComboBox3.SelectedItem.ToString()
        Dim paidDate = DateTimePicker1.Value.ToString("yyyy-MM-dd")

        Try
            conn.Open()
            sql = $"INSERT INTO customer_payments (customer_id, action, amount_paid, paid_date) VALUES( 
            '{customerID}', '{action}', '{amountPaid}', '{paidDate}')"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If

        Catch ex As MySqlException
            MsgBox("record not added. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim amountPaid = TextBox1.Text
        Dim payID = ComboBox1.SelectedItem.ToString()
        Dim customerID = ComboBox2.SelectedItem.ToString()
        Dim action = ComboBox3.SelectedItem.ToString()
        Dim paidDate = DateTimePicker1.Value.ToString("yyyy-MM-dd")
        Try
            conn.Open()

            sql = $"UPDATE customer_payments SET customer_id = '{customerID}', action = '{action}', amount_paid = '{amountPaid}', 
paid_date = '{paidDate}' WHERE payment_id = {payID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim customerID = ComboBox2.SelectedItem.ToString()
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM customers WHERE customer_id = {customerID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("record deleted")
                Else
                    MsgBox("record not deleted")
                End If
            End If
            TextBox1.Clear()
            ComboBox1.SelectedIndex = -1
            ComboBox2.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
            DateTimePicker1.Value = DateTime.Now
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        TextBox1.Clear()
        ComboBox1.SelectedIndex = -1
        ComboBox2.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
        DateTimePicker1.Value = DateTime.Now
    End Sub
End Class








------------------------------------------------------------------   ROOMS HAS EQUIPMENTS   ------------------------------------------------------------------------











Imports MySql.Data.MySqlClient

Public Class rooms_has_equipments
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub rooms_has_equipments_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM rooms_has_equipments"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "rooms_has_equipments")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "rooms_has_equipments"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("room_id"))
            End While
            dbread.Close()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("equipment_id"))
            End While
            dbread.Close()

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim equipID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM attendance_log WHERE log_id = " & equipID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox3.Text = dbread("room_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim roomID As String = ComboBox3.Text
        Try
            conn.Open()
            sql = "SELECT * FROM rooms_has_equipments WHERE room_id = " & roomID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox3.Text = dbread("equipment_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM rooms_has_equipments"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim roomID = Val(ComboBox1.SelectedItem)
        Dim equipID = Val(ComboBox3.SelectedItem)

        Try
            sql = $"SELECT * FROM rooms_has_equipments WHERE room_id = {roomID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "rooms_has_equipments")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "rooms_has_equipments"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("room_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim roomID = Val(ComboBox1.SelectedItem)
        Dim equipID = Val(ComboBox3.SelectedItem)

        Try
            conn.Open()

            sql = $"INSERT INTO rooms_has_equipments (room_id, equipment_id) VALUES('{roomID}', '{equipID}')"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If
            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox("Department not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim roomID = Val(ComboBox1.SelectedItem)
        Dim equipID = Val(ComboBox3.SelectedItem)

        Try
            conn.Open()

            sql = $"UPDATE rooms_has_equipments SET equipment_id = '{equipID}' WHERE room_id = {roomID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim roomID = Val(ComboBox1.SelectedItem)
        Dim equipID = Val(ComboBox3.SelectedItem)
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM rooms_has_equipments WHERE room_id = {Val(ComboBox1.SelectedItem)}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("record deleted")
                Else
                    MsgBox("record not deleted")
                End If
            End If
            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        ComboBox1.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Try
            conn.Open()
            Dim equipID As String = InputBox("Enter the new equipments:", "Add equipment")

            sql = $"INSERT INTO rooms_has_equipments (equipment_id) VALUES ('{equipID}')"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            MsgBox("record saved.")

        Catch ex As Exception
            MsgBox("record not saved: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class









-----------------------------------------------------     MENU HAS INGREDIENTS    -------------------------------------------------------------------------










Imports MySql.Data.MySqlClient

Public Class food_has_ingredients
    Public conn As New MySqlConnection("server=localhost;user id=root;password=;database=KTV_Database_System")
    Public sql As String
    Public dbcomm As MySqlCommand
    Public dbread As MySqlDataReader
    Public DataAdapter1 As MySqlDataAdapter
    Public ds As DataSet
    Public adapter As MySqlDataAdapter
    Public table As DataTable = New DataTable()
    Private Sub food_has_ingredients_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            conn.Open()

            sql = "SELECT * FROM food_has_ingredients"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "food_has_ingredients")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "food_has_ingredients"
            conn.Close()

            conn.Open()
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            While dbread.Read()
                ComboBox1.Items.Add(dbread("menu_id"))
            End While
            dbread.Close()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("food_id"))
            End While
            dbread.Close()

        Catch ex As Exception
            MsgBox("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox3.SelectedIndexChanged
        Dim foodID As String = ComboBox3.Text
        Try
            conn.Open()
            sql = "SELECT * FROM menu_has_ingredients WHERE food_id = " & foodID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox1.Text = dbread("menu_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged
        Dim menuID As String = ComboBox1.Text
        Try
            conn.Open()
            sql = "SELECT * FROM menu_has_ingredients WHERE menu_id = " & menuID

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            ComboBox3.Text = dbread("food_id")

        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Try
            conn.Open()
            Dim menuID As String = InputBox("Enter the new ingredient:", "Add ingredient")

            sql = $"INSERT INTO menu_has_ingredients (menu_id) VALUES ('{menuID}')"
            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()
            dbread.Read()

            MsgBox("record saved.")

        Catch ex As Exception
            MsgBox("record not saved: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            conn.Open()
            Dim query As String = "SELECT * FROM menu_has_ingredients"
            adapter = New MySqlDataAdapter(query, conn)
            table.Clear()
            adapter.Fill(table)
            DataGridView1.DataSource = Nothing
            DataGridView1.DataSource = table
        Catch ex As Exception
            MessageBox.Show("Error loading data: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim menuID = Val(ComboBox1.SelectedItem)
        Dim foodID = Val(ComboBox3.SelectedItem)

        Try
            sql = $"SELECT * FROM menu_has_ingredients WHERE menu_id = {menuID}"
            DataAdapter1 = New MySqlDataAdapter(sql, conn)
            ds = New DataSet()
            DataAdapter1.Fill(ds, "menu_has_ingredients")
            DataGridView1.DataSource = ds
            DataGridView1.DataMember = "menu_has_ingredients"

            dbcomm = New MySqlCommand(sql, conn)
            dbread = dbcomm.ExecuteReader()

            ComboBox1.Items.Clear()
            While dbread.Read()
                ComboBox1.Items.Add(dbread("menu_id"))
            End While

            ComboBox3.Items.Clear()
            While dbread.Read()
                ComboBox3.Items.Add(dbread("food_id"))
            End While

            dbread.Close()
        Catch ex As Exception
            MsgBox("Error in collecting data from Database. Error is :" & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Dim menuID = Val(ComboBox1.SelectedItem)
        Dim foodID = Val(ComboBox3.SelectedItem)

        Try
            conn.Open()

            sql = $"INSERT INTO menu_has_ingredients (menu_id, food_id) VALUES('{menuID}', '{FoodID}')"
            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("Record saved successfully.")
            Else
                MsgBox("Record not saved.")
            End If
            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox("Department not created. Error: " & ex.Message)
        Finally
            conn.Close()
        End Try
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Dim menuID = Val(ComboBox1.SelectedItem)
        Dim foodID = Val(ComboBox3.SelectedItem)
        Try
            conn.Open()

            sql = $"UPDATE menu_has_ingredients SET food_id = '{foodID}' WHERE menu_id = {menuID}"

            dbcomm = New MySqlCommand(sql, conn)
            Dim i As Integer = dbcomm.ExecuteNonQuery

            If (i > 0) Then
                MsgBox("record updated")
            Else
                MsgBox("record not updated")

            End If

        Catch ex As Exception
            MsgBox("Error updating record: " & ex.Message)
        End Try
        conn.Close()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim menuID = Val(ComboBox1.SelectedItem)
        Dim i As Integer
        Try
            conn.Open()

            Dim ans = MessageBox.Show("do you want to delete this record?", "record deleted", MessageBoxButtons.YesNoCancel)
            If ans = DialogResult.Yes Then
                sql = $"DELETE FROM menu_has_ingredients WHERE menu_id = {menuID}"
                dbcomm = New MySqlCommand(sql, conn)
                i = dbcomm.ExecuteNonQuery

                If (i > 0) Then
                    MsgBox("record deleted")
                Else
                    MsgBox("record not deleted")
                End If
            End If
            ComboBox1.SelectedIndex = -1
            ComboBox3.SelectedIndex = -1
        Catch ex As MySqlException
            MsgBox(ex.Message)
        Catch ex As Exception
            MsgBox(ex.Message)

        End Try
        conn.Close()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        ComboBox1.SelectedIndex = -1
        ComboBox3.SelectedIndex = -1
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Me.Hide()
        admin_buttons.Show()
    End Sub
End Class











-----


